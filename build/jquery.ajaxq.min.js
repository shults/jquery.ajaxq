!function(a){"use strict";var b=a.jQuery||a.Zepto||a.$;if("undefined"==typeof b)throw"jquery.ajaxq requires jQuery or jQuery-compatible library (e.g. Zepto.js)";var c=Array.prototype.slice,d=function(a){function d(a,c){this._aborted=!1,this._jqXHR=null,this._calls={},this._args=[a,c],this._deferred=b.Deferred(),this.readyState=1}var e=d.prototype;b.extend(e,{run:function(){var a,c,d,e=this._deferred;if(null!==this._jqXHR)return this._jqXHR;this._jqXHR=b.ajax.apply(b,this._args),this._jqXHR.done(function(){e.resolve.apply(e,arguments)}),this._jqXHR.fail(function(){e.reject.apply(e,arguments)}),this._aborted&&this._jqXHR.abort(this.statusText);for(a in this._calls){c=this._calls[a];for(var d in c)this._jqXHR[a].apply(this._jqXHR,c[d])}return this._jqXHR},_call:function(a,b){return null!==this._jqXHR?this._jqXHR[a].apply(this._jqXHR,b):(this._calls[a]=this._calls[a]||[],this._calls[a].push(b),this)},abort:function(a){if(null!==this._jqXHR){var c=this,d=["readyState","status","statusText"],e=this._jqXHR.abort.apply(this._jqXHR,arguments);return b.each(d,function(a,b){c[b]=e[b]}),e}return this.statusText=a||"abort",this.status=0,this.readyState=0,this._aborted=!0,this},state:function(){return null!==this._jqXHR?this._jqXHR.state.apply(this._jqXHR,arguments):"pending"}});var f=["setRequestHeader","overrideMimeType","statusCode","done","fail","progress","complete","success","error","always"];b.each(f,function(a,b){e[b]=function(){return this._call(b,c.call(arguments))}});var g=["getResponseHeader","getAllResponseHeaders"];b.each(g,function(a,b){e[b]=function(){return null!==this._jqXHR?this._jqXHR[b].apply(this,arguments):null}});var h=["pipe","then","promise"];return b.each(h,function(a,b){e[b]=function(){return this._deferred[b].apply(this._deferred,arguments)}}),d}(),e=function(){function a(a){if("undefined"!=typeof a&&!b.isNumeric(a))throw"number expected";if(this._bandwidth=parseInt(a||1,10),this._bandwidth<1)throw"Bandwidth can't be less then 1";this._started=[],this._queue=[]}function c(a){var b=this._started.indexOf(a),d=this._queue.shift();-1!==b&&this._started.splice(b,1),"undefined"!=typeof d&&(d.always(c.bind(this,d)),d.run())}return b.extend(a.prototype,{ajax:function(a,b){var e=new d(a,b);return this._started.length<this._bandwidth?(this._started.push(e),e.always(c.bind(this,e)),e.run()):this._queue.push(e),e},getJSON:function(a,b,c){return this.get(a,b,c,"json")}}),b.each(["get","post"],function(c,d){a.prototype[d]=function(a,c,e,f){return b.isFunction(c)&&(f=f||e,e=c,c=void 0),this.ajax({url:a,type:d,dataType:f,data:c,success:e})}}),a}();if("undefined"!=typeof b.ajaxq)throw"Namespace $.ajaxq is Alread y busy.";var f=new e;b.ajaxq=function(a,b){return f.ajax.apply(f,arguments)},b.each(["get","post","getJSON"],function(a,c){b.ajaxq[c]=function(){return f[c].apply(f,arguments)}}),b.ajaxq.Queue=function(a){return new e(a)},b.ajaxq.Request=function(a,b){return new d(a,b)}}(this);